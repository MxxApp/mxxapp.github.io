# 一机多用、多用户共享电脑方案整理

本文档介绍两种主流的 Windows 多用户共享/分屏或串流方案，并附带详细配置流程、实用技巧及相关工具记录，方便电脑并排或远程办公、娱乐使用。

---

## 1. 方案一：ASTER——本地多用户拖机方案

- **软件名称**：ASTER
- **功能简介**：让一台电脑同时连接多组键鼠+显示器，每人独立操作。适合物理机临近共享办公/娱乐。
- **授权与价格**：14天免费试用，永久2用户版需298元
- **购买/下载**：  
  - 国内官网：[https://ibik.cn/](https://ibik.cn/)  
  - 俄罗斯官网：[https://www.ibik.ru/](https://www.ibik.ru/)
- **适用场景**：电脑物理接近、资源充足、硬件可扩展（如多显示器）环境。

---

## 2. 方案二：串流方案——Duo + Sunshine + Moonlight

- **核心**：Duo 支持多用户远程串流登录，并可与 Sunshine 和 Moonlight 搭配，实现云桌面功能。
- **开源主页**：[https://github.com/DuoStream/Duo](https://github.com/DuoStream/Duo)
- **授权模式**：免费（但免费版限1个实例和最高30Hz显示输出）

### 2.1 Duo 搭建详细流程

#### （1）Windows 本地准备

- 新增一个 Windows 用户（可以用空密码）
- **注意**：Win系统默认空密码无法远程，需要解锁对应策略：
  1. `Win+R`，输入 `gpedit.msc` 打开组策略编辑器
  2. 按此路径依次进入：  
     `计算机配置 > Windows设置 > 安全设置 > 本地策略 > 安全选项`
  3. 右侧找到“账户：使用空密码的本地账户只允许进行控制台登录”，改为**禁用**

#### （2）新用户环境配置

- 切换登录到新建账号，配置好桌面环境
- 为防止其它用户关机/重启主机，请配置独立的组策略：
  - `mmc` > 添加/删除管理单元 > 组策略对象编辑器 > 选择新建的用户
  - 路径：  
    `用户配置 > 管理模板 > “开始”菜单和任务栏`
  - 启用“删除并阻止访问‘关机’、‘重启’、‘睡眠’和‘休眠’命令”
  - （可选）启用“删除‘开始’菜单上的‘注销’”

#### （3）沙箱隔离（推荐）

配合 [Sandboxie](https://github.com/sandboxie-plus/Sandboxie) 使用，多开同一个应用互不影响。

- 示例快捷方式：
  - 普通模式：  
    ```
    "C:\Program Files\Sandboxie-Plus\Start.exe" /box:DefaultBox D:\Game\test.exe
    ```
  - 最小化silent启动：  
    ```
    "C:\Program Files\Sandboxie-Plus\Start.exe" /box:DefaultBox D:\Game\Steam\steam.exe -silent
    ```
  - 管理员启动：  
    ```
    "C:\Program Files\Sandboxie-Plus\Start.exe" /box:DefaultBox /elevate "D:\Game\HMCL-3.12.0.328.exe"
    ```
- **自启动配置**：在新账号下运行 `shell:startup`，将需要随机启动项目的快捷方式放入即可。

#### （4）安装与运行 Duo

- 安装 Duo
- 运行 Duo Manager：`+New` 创建实例，设置好后 `Start` 启动
- 配置 Sunshine（[传送门](https://github.com/LizardByte/Sunshine)）账号密码
- 使用 Moonlight（[传送门](https://github.com/moonlight-stream)）等串流客户端连接

---

## 3. 自动断开串流连接脚本（VBS）

对于不懂如何断流的用户，可制作 Sunshine 控制API的快捷脚本：

```vbscript
' Sunshine 断开连接脚本范例
Dim user, pass, url, auth, curlCmd
user = "用户名"  ' 填写实际用户名
pass = "密码"    ' 填写实际密码
url = "https://127.0.0.1:31609/api/apps/close"

auth = user & ":" & pass
curlCmd = "curl.exe -s -k -u " & auth & " -H ""Content-Type: application/json"" -X POST " & url

Set shell = CreateObject("WScript.Shell")
shell.Run curlCmd, 0, True

' 如需提醒，去掉下行注释
' MsgBox "远程连接已断开", 64, "提示"
```
> 保存为 `.vbs`，改好账号密码，制作成快捷方式即可一键断开。

---

## 4. 相关开源项目及资源

- [Sunshine](https://github.com/LizardByte/Sunshine)：支持多端高性能串流的服务器端
- [Moonlight](https://github.com/moonlight-stream)：主流串流客户端
- [Apollo](https://github.com/ClassicOldSong/Apollo)：Sunshine 管理工具
- [Vibepollo](https://github.com/Nonary/Vibepollo)：Moonlight 增强客户端
- [Sandboxie](https://github.com/sandboxie-plus/Sandboxie)：应用沙盒隔离必备

---
